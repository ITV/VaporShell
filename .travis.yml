language: cpp
python:
  - "3.4"

git:
  depth: 1000

os:
  - linux
  - osx
sudo: required
dist: trusty
osx_image: xcode8.3

before_install:
  - chmod +x ci/download.sh
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then
      brew update;
      brew install openssl;
      mkdir -p /usr/local/lib;
      ln -s /usr/local/opt/openssl/lib/libcrypto.1.0.0.dylib /usr/local/lib/;
      ln -s /usr/local/opt/openssl/lib/libssl.1.0.0.dylib /usr/local/lib/;
    fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then
      chmod +x ci/awscreds.sh;
      ./ci/awscreds.sh;
      sudo apt-get -y install python3-pip python-dev;
      python3 -V;
      pip3 -V;
      sudo pip3 install --upgrade --user awscli;
      export PATH=$PATH:$HOME/.local/bin;
      nvm install v6.0.0;
    fi
install:
  - pushd ci
  - ./download.sh
  - popd

script:
  - ulimit -n 4096
  - powershell -File ci/init.ps1
notifications:
  slack:
    rooms:
      secure: iz1UiFt7Azg+pDmhmYcMy8qULbh/AaX8V5l3WXaKUYU7P7N2/GbB+uT623cFXEo34EKU0SkFWxSMK4fUzl4y+uJV5CVs/XJ6CFceymO+o7L6h/uBcbnW21mO1o/XWamegSlmmG9VTZCPG6BXDBFacLvRMgta8Bwut4rPzHwlnQGJihKzENEJKsrLTABq3at4TLsASiqut4c68KaAtK3euW0M3ZA/vvP3kbpMaZwDsJ7bTIuZrFTZ46GePtBPVklXJCUJh9X50cZt7jT90cOQD0456uSURlBm2AVfXpFK1N0WhRIHqy67Ub8sL7zwuCIROFlKm0NOU0OB2s2Vvqb8yGiA9MbO8nv1HsdIaR01a1DA/vglnkAnnYJoYWZjh7lUI10Lb7vmNIz3EIt5BtP/zXueZSbjik6cyhmt9eQcziq/fzblWIOPa3DxnE/PthzisbmxvQUMVQ2qUgiQ1Rf1WQDpSUTUeur80MAcaG27Q3EbE463bwCCcr912UzBTFaz026wFVB2EBYQTZsf9SI5/7TKF0dHQMf6yTG4NNfNarr4Zv9/Tunj4V3nKiFlIsgpxF38OOytRytK+qGGQR+E8VSv79Et3pltKCUaym674PLVgSgCx2dq2xUuJ/PQvPZv6x3piiS6VWgsnPqzk9vZhV7qQSv/Cp5+sEYqPC5yQBw=